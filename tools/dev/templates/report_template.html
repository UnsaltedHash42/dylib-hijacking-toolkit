<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dylib Hijack Scan Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/datatables@1.10.18/media/css/jquery.dataTables.min.css" rel="stylesheet">
    <style>
        .severity-critical { color: #dc3545; }
        .severity-high { color: #fd7e14; }
        .severity-medium { color: #ffc107; }
        .severity-low { color: #20c997; }
        .severity-info { color: #0dcaf0; }
        
        .vulnerability-card {
            margin-bottom: 1rem;
            border-left: 4px solid;
        }
        
        .vulnerability-card.critical { border-left-color: #dc3545; }
        .vulnerability-card.high { border-left-color: #fd7e14; }
        .vulnerability-card.medium { border-left-color: #ffc107; }
        .vulnerability-card.low { border-left-color: #20c997; }
        .vulnerability-card.info { border-left-color: #0dcaf0; }
        
        .stats-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .chart-container {
            height: 300px;
            margin-bottom: 2rem;
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <h1 class="mb-4">Dylib Hijack Scan Report</h1>
        
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="stats-card">
                    <h5>Scan Information</h5>
                    <p><strong>Generated:</strong> {{ timestamp }}</p>
                    <p><strong>System:</strong> {{ system_info }}</p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="stats-card">
                    <h5>Summary</h5>
                    <p><strong>Total Vulnerabilities:</strong> {{ vulnerabilities|length }}</p>
                    <p><strong>Critical:</strong> {{ vulnerabilities|selectattr('severity.value', 'equalto', 'Critical')|list|length }}</p>
                    <p><strong>High:</strong> {{ vulnerabilities|selectattr('severity.value', 'equalto', 'High')|list|length }}</p>
                    <p><strong>Medium:</strong> {{ vulnerabilities|selectattr('severity.value', 'equalto', 'Medium')|list|length }}</p>
                    <p><strong>Low:</strong> {{ vulnerabilities|selectattr('severity.value', 'equalto', 'Low')|list|length }}</p>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Vulnerabilities</h5>
                    </div>
                    <div class="card-body">
                        <table id="vulnerabilities-table" class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Severity</th>
                                    <th>Binary Path</th>
                                    <th>Dylib Path</th>
                                    <th>Description</th>
                                    <th>Mitigation</th>
                                    <th>CVE</th>
                                    <th>Exploit Complexity</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for vuln in vulnerabilities %}
                                <tr>
                                    <td class="severity-{{ vuln.severity.value|lower }}">{{ vuln.severity.value }}</td>
                                    <td>{{ vuln.binary_path }}</td>
                                    <td>{{ vuln.dylib_path }}</td>
                                    <td>{{ vuln.description }}</td>
                                    <td>{{ vuln.mitigation }}</td>
                                    <td>{{ vuln.cve_reference or 'N/A' }}</td>
                                    <td>{{ vuln.exploit_complexity or 'N/A' }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            {% for severity in ['Critical', 'High', 'Medium', 'Low', 'Info'] %}
            <div class="col-12">
                <h3 class="mb-3">{{ severity }} Severity Issues</h3>
                {% for vuln in vulnerabilities if vuln.severity.value == severity %}
                <div class="card vulnerability-card {{ severity|lower }}">
                    <div class="card-body">
                        <h5 class="card-title">{{ vuln.binary_path }}</h5>
                        <h6 class="card-subtitle mb-2 text-muted">{{ vuln.dylib_path }}</h6>
                        <p class="card-text">{{ vuln.description }}</p>
                        <div class="mt-3">
                            <strong>Mitigation:</strong>
                            <p>{{ vuln.mitigation }}</p>
                            {% if vuln.cve_reference %}
                            <strong>CVE Reference:</strong>
                            <p>{{ vuln.cve_reference }}</p>
                            {% endif %}
                            {% if vuln.exploit_complexity %}
                            <strong>Exploit Complexity:</strong>
                            <p>{{ vuln.exploit_complexity }}</p>
                            {% endif %}
                            {% if vuln.affected_versions %}
                            <strong>Affected Versions:</strong>
                            <p>{{ vuln.affected_versions|join(', ') }}</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/datatables@1.10.18/media/js/jquery.dataTables.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#vulnerabilities-table').DataTable({
                order: [[0, 'desc']],
                pageLength: 25,
                responsive: true
            });
        });
    </script>
</body>
</html> 